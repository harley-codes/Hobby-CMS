generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "cockroachdb"
    url      = env("DATABASE_PRISMA_COCKROACH_DATABASE_URL")
}

model Project {
    id           String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
    name         String        @db.String()
    active       Boolean       @db.Bool
    meta         Json          @db.JsonB
    // Relational
    posts        Post[]
    accessTokens AccessToken[]
}

model AccessToken {
    id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
    idProject String?  @db.Uuid
    token     String   @default(dbgenerated("md5(random()::text)")) @db.String()
    // Relational
    project   Project? @relation(fields: [idProject], references: [id])
}

model Post {
    id               String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
    idProject        String?    @db.Uuid
    title            String     @db.String()
    description      String?    @db.String()
    featuredImageURL String?    @db.String()
    date             Int        @db.Int4
    blocks           Json       @db.JsonB
    meta             Json       @db.JsonB
    tags             Json       @db.JsonB
    status           PostStatus
    // Relational
    project          Project?   @relation(fields: [idProject], references: [id])
}

enum PostStatus {
    ACTIVE
    DISABLED
    HIDDEN
}

model DataFile {
    id            String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
    name          String  @db.String()
    date          Int     @db.Int4
    fileMimeType  String  @db.String()
    fileExtension String  @db.String()
    data64        String  @db.String()
    hasThumbnail  Boolean @db.Bool
    thumbnail64   String? @db.String()
    fileSizeKb    Int     @db.Int4
}
